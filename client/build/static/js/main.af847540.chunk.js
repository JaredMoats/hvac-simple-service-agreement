(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{38:function(e,a,t){e.exports=t(65)},65:function(e,a,t){"use strict";t.r(a);var n=t(0),r=t.n(n),l=t(30),s=t.n(l),c=t(31),o=t(32),m=t(36),i=t(33),u=t(37),d=t(2),p=t(13),h=t(5),E=t.n(h),b=t(11),f=t(9),N=t(12),v=t(7),g=t(10),k=t.n(g),y=function(e){var a=e.storeToken,t=e.getToken,l=(e.setActiveUser,Object(n.useState)({firstName:"",lastName:"",email:"",companyName:"",password:"",password2:"",role:"",selectedOption:""})),s=Object(v.a)(l,2),c=s[0],o=s[1],m=Object(n.useState)({toLogin:!1}),i=Object(v.a)(m,2),u=i[0],h=i[1],g=c.firstName,y=c.lastName,x=c.email,C=c.companyName,w=c.password,O=c.password2,j=c.role,S=c.selectedOption,T=u.toLogin,P=function(e){var a;o(Object(N.a)({},c,(a={},Object(f.a)(a,e.target.name,e.target.value),Object(f.a)(a,"selectedOption",e.target.value),a)))},A=function(){var e=Object(b.a)(E.a.mark(function e(n){var r,l,s;return E.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n.preventDefault(),w===O){e.next=5;break}alert("Passwords do not match"),e.next=23;break;case 5:return r={headers:{"Content-Type":"application/json"}},l=JSON.stringify({firstName:g,lastName:y,companyName:C,email:x,password:w,role:j}),console.log("JSON form data: "+l),e.prev=8,e.next=11,k.a.post("/api/employees",l,r);case 11:s=e.sent,a(s.data.token),t(),console.log("Token set in headers object"),console.log("toDashboard: "+T),h({toLogin:!0}),e.next=23;break;case 20:e.prev=20,e.t0=e.catch(8),console.log(e.t0.response.data);case 23:case"end":return e.stop()}},e,null,[[8,20]])}));return function(a){return e.apply(this,arguments)}}();return T?r.a.createElement(p.a,{to:"/login"}):r.a.createElement(n.Fragment,null,r.a.createElement("h1",{className:"has-text-black",style:{fontSize:"40px"}},"Welcome to Simple Service Agreement"),r.a.createElement("h2",{className:"has-text-black",style:{fontSize:"20px"}},"Register or ",r.a.createElement(d.b,{to:"/login"},"Login")),r.a.createElement("div",{className:"card"},r.a.createElement("form",{onSubmit:function(e){return A(e)}},r.a.createElement("div",{className:"field"},r.a.createElement("label",{className:"label"},"First Name"),r.a.createElement("div",{className:"control has-icons-left"},r.a.createElement("input",{className:"input",type:"text",placeholder:"First Name",name:"firstName",value:g,onChange:function(e){return P(e)},required:!0}))),r.a.createElement("div",{className:"field"},r.a.createElement("label",{className:"label"},"Last Name"),r.a.createElement("div",{className:"control has-icons-left"},r.a.createElement("input",{className:"input",type:"text",placeholder:"Last Name",name:"lastName",value:y,onChange:function(e){return P(e)},required:!0}))),r.a.createElement("div",{className:"field"},r.a.createElement("label",{className:"label"},"Company Name"),r.a.createElement("div",{className:"control has-icons-left"},r.a.createElement("input",{className:"input",type:"text",placeholder:"Company Name",name:"companyName",value:C,onChange:function(e){return P(e)},required:!0}))),r.a.createElement("div",{className:"field"},r.a.createElement("label",{className:"label"},"Email"),r.a.createElement("div",{className:"control has-icons-left"},r.a.createElement("input",{className:"input",type:"text",placeholder:"Email",name:"email",value:x,onChange:function(e){return P(e)},required:!0}))),r.a.createElement("div",{className:"field"},r.a.createElement("label",{className:"label"},"Password"),r.a.createElement("div",{className:"control has-icons-left"},r.a.createElement("input",{className:"input",type:"password",placeholder:"Password",name:"password",value:w,onChange:function(e){return P(e)},required:!0}))),r.a.createElement("div",{className:"field"},r.a.createElement("label",{className:"label"},"Confirm Password"),r.a.createElement("div",{className:"control has-icons-left"},r.a.createElement("input",{className:"input",type:"password",placeholder:"Confirm Password",name:"password2",value:O,onChange:function(e){return P(e)},required:!0}))),r.a.createElement("div",{className:"field"},r.a.createElement("label",{className:"radio"},"Technician",r.a.createElement("input",{type:"radio",name:"role",value:"technician",checked:"technician"===S,onChange:function(e){return P(e)}})),r.a.createElement("label",{className:"radio"},"Dispatcher",r.a.createElement("input",{type:"radio",name:"role",value:"dispatcher",checked:"dispatcher"===S,onChange:function(e){return P(e)}})),r.a.createElement("label",{className:"radio"},"Dealer",r.a.createElement("input",{type:"radio",name:"role",value:"dealer",checked:"dealer"===S,onChange:function(e){return P(e)}}))),r.a.createElement("input",{type:"submit",className:"button is-success"}))))},x=function(e){var a=e.storeToken,t=e.getToken,l=e.setActiveUser,s=Object(n.useState)({email:"",password:""}),c=Object(v.a)(s,2),o=c[0],m=c[1],i=Object(n.useState)({toDashboard:!1}),u=Object(v.a)(i,2),h=u[0],g=u[1],y=o.email,x=o.password,C=h.toDashboard,w={fontSize:"20px"},O=function(e){m(Object(N.a)({},o,Object(f.a)({},e.target.name,e.target.value)))},j=function(){var e=Object(b.a)(E.a.mark(function e(n){var r,s,c,o,m,i;return E.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),r={headers:{"Content-Type":"application/json"}},s=JSON.stringify({email:y,password:x}),e.prev=7,e.next=10,k.a.post("/api/auth",s,r);case 10:return c=e.sent,a(c.data.token),o=t(),m={"x-auth-token":o},e.next=16,k.a.get("/api/employees/me",{headers:m});case 16:i=e.sent,l(i),g({toDashboard:!0}),e.next=24;break;case 21:e.prev=21,e.t0=e.catch(7),console.log(e.t0.message);case 24:case"end":return e.stop()}},e,null,[[7,21]])}));return function(a){return e.apply(this,arguments)}}();return C?r.a.createElement(p.a,{to:"/dashboard"}):r.a.createElement(n.Fragment,null,r.a.createElement("h1",{className:"has-text-black",style:{fontSize:"40px"}},"Welcome to Simple Service Agreement"),r.a.createElement("h2",{className:"has-text-black",style:w},"Login or ",r.a.createElement(d.b,{to:"/"},"Register")),r.a.createElement("h2",{className:"has-text-black",style:w},r.a.createElement(d.b,{to:"/dashboard"},"Dashboard")),r.a.createElement("div",{className:"card"},r.a.createElement("form",{onSubmit:function(e){return j(e)}},r.a.createElement("div",{className:"field"},r.a.createElement("label",{className:"label"},"Email"),r.a.createElement("div",{className:"control has-icons-left"},r.a.createElement("input",{className:"input",type:"text",placeholder:"Email",name:"email",value:y,onChange:function(e){return O(e)},required:!0}))),r.a.createElement("div",{className:"field"},r.a.createElement("label",{className:"label"},"Password"),r.a.createElement("div",{className:"control has-icons-left"},r.a.createElement("input",{className:"input",type:"password",placeholder:"Password",name:"password",value:x,onChange:function(e){return O(e)},required:!0}))),r.a.createElement("input",{type:"submit",className:"button is-success"}))))},C=function(){return r.a.createElement("nav",{className:"navbar",role:"navigation","aria-label":"main navigation"},r.a.createElement("div",{className:"navbar-start"},r.a.createElement(d.b,{to:"/dashboard",className:"navbar-item"},"Dashboard"),r.a.createElement(d.b,{to:"/dashboard",className:"navbar-item"},"New Service Call"),r.a.createElement(d.b,{to:"/create-customer",className:"navbar-item"},"New Customer"),r.a.createElement(d.b,{to:"/all-customers",className:"navbar-item"},"All Customers"),r.a.createElement(d.b,{to:"/dashboard",className:"navbar-item"},"Look Up Customer"),r.a.createElement(d.b,{to:"/dashboard",className:"navbar-item"},"All Technicians")))},w=function(e){e.setActiveUser;var a=e.activeUser;e.getToken;return a?r.a.createElement(n.Fragment,null,r.a.createElement(C,null),r.a.createElement("h1",null,"Welcome back, ",console.log("Active user: "+a)," ",a?a.data.firstName:"<name>",".")):r.a.createElement("h1",null,"You must be logged in to do that")},O=function(e){var a=e.activeUser,t=e.getToken,l=Object(n.useState)({firstName:"",lastName:"",email:"",streetAddress:"",state:"",zipCode:"",homePhone:"",mobilePhone:"",workPhone:"",canText:!1,canEmail:!1,inCityLimits:!0,notes:""}),s=Object(v.a)(l,2),c=s[0],o=s[1],m=Object(n.useState)({toDashboard:!1}),i=Object(v.a)(m,2),u=i[0],d=i[1],h=u.toDashboard,g=c.firstName,y=c.lastName,x=c.email,w=c.streetAddress,O=c.state,j=c.zipCode,S=c.homePhone,T=c.mobilePhone,P=c.workPhone,A=c.canText,U=c.canEmail,q=c.inCityLimits,D=c.notes,F=function(e){o(Object(N.a)({},c,Object(f.a)({},e.target.name,e.target.value)))},L=function(){var e=Object(b.a)(E.a.mark(function e(a){var n,r,l;return E.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a.preventDefault(),n=JSON.stringify({firstName:g,lastName:y,email:x,streetAddress:w,state:O,zipCode:j,homePhone:S,mobilePhone:T,workPhone:P,canText:A,canEmail:U,inCityLimits:q,notes:D}),e.prev=2,r=t()){e.next=7;break}return console.log("There is no token"),e.abrupt("return","There is no token");case 7:return l={headers:{"Content-Type":"application/json","x-auth-token":r}},e.next=10,k.a.post("/api/customers",n,l);case 10:e.sent,d({toDashboard:!0}),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(2),console.log(e.t0.message);case 17:case"end":return e.stop()}},e,null,[[2,14]])}));return function(a){return e.apply(this,arguments)}}();return a?h?r.a.createElement(p.a,{to:"/dashboard"}):r.a.createElement(n.Fragment,null,r.a.createElement(C,null),r.a.createElement("div",{className:"card"},r.a.createElement("h1",null,"Create customer"),r.a.createElement("form",{onSubmit:function(e){return L(e)}},r.a.createElement("div",{className:"field"},r.a.createElement("label",{className:"label"},"First Name"),r.a.createElement("div",{className:"control has-icons-left"},r.a.createElement("input",{className:"input",type:"text",placeholder:"First Name",name:"firstName",value:g,onChange:function(e){return F(e)},required:!0}))),r.a.createElement("div",{className:"field"},r.a.createElement("label",{className:"label"},"Last Name"),r.a.createElement("div",{className:"control has-icons-left"},r.a.createElement("input",{className:"input",type:"text",placeholder:"Last Name",name:"lastName",value:y,onChange:function(e){return F(e)},required:!0}))),r.a.createElement("div",{className:"field"},r.a.createElement("label",{className:"label"},"Email"),r.a.createElement("div",{className:"control has-icons-left"},r.a.createElement("input",{className:"input",type:"email",placeholder:"Email",name:"email",value:x,onChange:function(e){return F(e)},required:!0}))),r.a.createElement("div",{className:"field"},r.a.createElement("label",{className:"label"},"Street Address"),r.a.createElement("div",{className:"control has-icons-left"},r.a.createElement("input",{className:"input",type:"text",placeholder:"Street Address",name:"streetAddress",value:w,onChange:function(e){return F(e)},required:!0}))),r.a.createElement("div",{className:"field"},r.a.createElement("label",{className:"label"},"State"),r.a.createElement("div",{className:"control has-icons-left"},r.a.createElement("input",{className:"input",type:"text",placeholder:"State",name:"state",value:O,onChange:function(e){return F(e)},required:!0}))),r.a.createElement("div",{className:"field"},r.a.createElement("label",{className:"label"},"Zip Code"),r.a.createElement("div",{className:"control has-icons-left"},r.a.createElement("input",{className:"input",type:"text",placeholder:"Zip Code",name:"zipCode",value:j,onChange:function(e){return F(e)},required:!0}))),r.a.createElement("div",{className:"field"},r.a.createElement("label",{className:"label"},"Home Phone"),r.a.createElement("div",{className:"control has-icons-left"},r.a.createElement("input",{className:"input",type:"text",placeholder:"Home Phone",name:"homePhone",value:S,onChange:function(e){return F(e)},required:!0}))),r.a.createElement("div",{className:"field"},r.a.createElement("label",{className:"label"},"Mobile Phone"),r.a.createElement("div",{className:"control has-icons-left"},r.a.createElement("input",{className:"input",type:"text",placeholder:"Mobile Phone",name:"mobilePhone",value:T,onChange:function(e){return F(e)},required:!0}))),r.a.createElement("div",{className:"field"},r.a.createElement("label",{className:"label"},"Work Phone"),r.a.createElement("div",{className:"control has-icons-left"},r.a.createElement("input",{className:"input",type:"text",placeholder:"Work Phone",name:"workPhone",value:P,onChange:function(e){return F(e)},required:!0}))),r.a.createElement("div",{className:"field"},r.a.createElement("label",{className:"label"},"Notes"),r.a.createElement("div",{className:"control has-icons-left"},r.a.createElement("input",{className:"input",type:"text",placeholder:"Notes",name:"notes",value:D,onChange:function(e){return F(e)},required:!0}))),r.a.createElement("input",{type:"submit",className:"button is-success"})))):r.a.createElement("h1",null,"You must be logged in to do that")},j=function(e){var a=e.getToken,t=e.activeUser,l=Object(n.useState)({customersData:null}),s=Object(v.a)(l,2),c=s[0],o=s[1],m=c.customersData;return Object(n.useEffect)(function(){function e(){return(e=Object(b.a)(E.a.mark(function e(){var t,n,r;return E.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t=a()){e.next=5;break}return console.log("From AllCustomers: No token"),e.abrupt("return",null);case 5:return n={"x-auth-token":t},e.next=8,k.a.get("/api/customers",{headers:n});case 8:if(r=e.sent){e.next=12;break}return console.log("From AllCustomers: Found no customers"),e.abrupt("return",null);case 12:o(Object(N.a)({},r,{customersData:r})),e.next=19;break;case 15:e.prev=15,e.t0=e.catch(0),console.log("Error in the AllCustomers component"),console.error(e.t0.message);case 19:case"end":return e.stop()}},e,null,[[0,15]])}))).apply(this,arguments)}!function(){e.apply(this,arguments)}()},[]),t?m?r.a.createElement(n.Fragment,null,r.a.createElement(C,null),r.a.createElement("h1",null,"Customers: "),m.data.map(function(e,a){return r.a.createElement("p",{key:a},"Customer: ",e.firstName," ",e.lastName," ")})):r.a.createElement(n.Fragment,null,r.a.createElement(C,null),r.a.createElement("h1",null,"No customers found")):r.a.createElement("h1",null,"You must be logged in to do that")},S=function(e){function a(){var e;return Object(c.a)(this,a),(e=Object(m.a)(this,Object(i.a)(a).call(this))).state={activeUser:null,tokenStored:!1},e}return Object(u.a)(a,e),Object(o.a)(a,[{key:"storeToken",value:function(e){localStorage.setItem("token",e),this.setState({tokenStored:!0}),console.log("Token stored")}},{key:"getToken",value:function(){return localStorage.getItem("token")}},{key:"setActiveUser",value:function(e){this.setState({activeUser:e})}},{key:"render",value:function(){var e=this;return r.a.createElement(d.a,null,r.a.createElement("div",{className:"container"},r.a.createElement(p.b,{exact:!0,path:"/",render:function(a){return r.a.createElement(y,{storeToken:function(a){return e.storeToken(a)},setActiveUser:function(a){return e.setActiveUser(a)},getToken:function(){return e.getToken()}})}}),r.a.createElement(p.d,null,r.a.createElement(p.b,{exact:!0,path:"/login",render:function(a){return r.a.createElement(x,{storeToken:function(a){return e.storeToken(a)},setActiveUser:function(a){return e.setActiveUser(a)},getToken:function(){return e.getToken()}})}}),r.a.createElement(p.b,{exact:!0,path:"/dashboard",render:function(a){return r.a.createElement(w,{activeUser:e.state.activeUser,ifActiveUser:function(a){return e.ifActiveUser(a)}})}}),r.a.createElement(p.b,{exact:!0,path:"/create-customer",render:function(a){return r.a.createElement(O,{activeUser:e.state.activeUser,getToken:function(){return e.getToken()}})}}),r.a.createElement(p.b,{exact:!0,path:"/all-customers",render:function(a){return r.a.createElement(j,{activeUser:e.state.activeUser,getToken:function(){return e.getToken()}})}}))))}}]),a}(n.Component);s.a.render(r.a.createElement(S,null),document.getElementById("root"))}},[[38,1,2]]]);
//# sourceMappingURL=main.af847540.chunk.js.map